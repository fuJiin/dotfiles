# ======= #
#
# This defines common shortcuts I use.
#
# Note that it assumes certain software is already installed,
# but does not guarantee or check its existence.
#
# Each section should specify how relevant software should be installed
#
# ======= #

# Chezmoi
# Install: brew install chezmoi
#
alias cz="chezmoi"

# Git
# Install: brew install git
#
alias gl="git log --pretty=oneline --abbrev-commit --graph"
alias gcp="git cherry-pick"

# Lazygit
# Install: brew install lazygit
#
alias lg="lazygit"

# From http://stackoverflow.com/questions/17983068/delete-local-git-branches-after-deleting-them-on-the-remote-repo
# Deletes branches that are gone from remote AND branches that are merged (excluding current and master)
gbp() {
  # Delete branches that are gone from remote (force delete)
  git branch -vv | awk '/: gone]/ {print $1}' | xargs git branch -D 2>/dev/null
  # Delete merged branches (safe delete, excluding current, main, and develop)
  git branch --merged | grep -Ev "(\*|main|develop)" | xargs -n 1 git branch -d 2>/dev/null
}

# Update main and prune both remote and local branches
alias gpp="git checkout main && git pull && git fetch -p && gbp"

# Docker
alias dx="docker exec"

# tmux
# Install: brew install tmux
#
function cch () {
    ssh $@ -t 'tmux -CC attach || tmux -CC'
}
alias tmx="tmux -CC attach || tmux -CC"

# Ghostty
# Install: brew install ghostty
#
alias gt="ghostty"

# Check to see if ~/.github/api_token.txt is defined.
# Exports global if it exists
if [ -f ~/.github/api_token.txt ]; then
  export HOMEBREW_GITHUB_API_TOKEN=$(cat ~/.github/api_token.txt)
fi

# Ruby
# Install via RVM (https://rvm.io/)
#
# Rails
alias bx="bundle exec"

# Padrino
alias px="padrino"

# Jekyll
alias jk="jekyll"

# Python
# Install via Anaconda or Homebrew
#
alias ipn="ipython notebook"
alias pa="source env/bin/activate"

# XCode
#
alias xc="open ./*.xcworkspace" # hack that assumes 1 workspace file

# Clojure
# Install: brew install clojure
#
alias lrx="[ -f ./.nrepl-port ] && lein repl :connect || lein repl"

# Lein Exec
alias lx="lein exec"

# Lein CLJSBuild
alias ljs="lein cljsbuild"

# Shadow CLJS
alias sdw="shadow-cljs"

# Misc
#
alias flushdns="dscacheutil -flushcache"

# Find PID taking up a port
port () {
    lsof -n -i:$1 | grep LISTEN
}
